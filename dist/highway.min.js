!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Highway",[],e):"object"==typeof exports?exports.Highway=e():t.Highway=e()}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){function n(){}n.prototype={on:function(t,e,n){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var i=this;function s(){i.off(t,s),e.apply(n,arguments)}return s._=e,this.on(t,s,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),i=0,s=n.length;i<s;i++)n[i].fn.apply(n[i].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),i=n[t],s=[];if(i&&e)for(var r=0,o=i.length;r<o;r++)i[r].fn!==e&&i[r].fn._!==e&&s.push(i[r]);return s.length?n[t]=s:delete n[t],this}},t.exports=n},function(t,e,n){"use strict";n.r(e);var i=n(0),s=n.n(i);const r=/\?([\w_\-.=&]+)/,o=/(#.*)$/,h=/(https?:\/\/[\w\-.]+)/,a=/https?:\/\/.*?(\/[\w_\-./]+)/;function u(t){const e=t.match(h);return e?e[1]:null}function c(t){const e=t.match(a);return e?e[1]:null}function l(t){const e=t.match(o);return e?e[1]:null}function p(t){const e=t.match(r);if(!e)return null;const n=e[1].split("&"),i={};for(let t=0;t<n.length;t++){const e=n[t].split("="),{0:s}=e,{1:r}=e;i[s]=r}return i}function f(t){return(new DOMParser).parseFromString(t,"text/html")}function m(t){return f(t).querySelector("[router-view]")}function d(t){return m(t).getAttribute("router-view")}var g={getDOM:f,getSlug:d,getView:m,getInfos:function(t){return{url:t,anchor:l(t),origin:u(t),params:p(t),pathname:c(t)}},getParam:function(t,e){const n=p(t);return n.hasOwnProperty(e)?n[e]:null},getParams:p,getOrigin:u,getAnchor:l,getPathname:c,getRenderer:function(t,e){const n=d(t);return e.hasOwnProperty(n)?e[n]:null},getTransition:function(t,e){if(void 0===e)return null;const n=d(t);return e.hasOwnProperty(n)&&e[n]?e[n]:e.hasOwnProperty("default")?e.default:null}};var w=class{constructor(t,e,n){this.view=e,this.page=g.getDOM(t),this.title=this.page.title,this.transition=n?new n(e):null,this.bodyClass=this.page.body.className,this.HTMLClass=this.page.documentElement.className,this.wrapper=null}show(){return new Promise(t=>{this.wrapper=document.querySelector("[router-wrapper]"),this.HTMLClass&&this.HTMLClass!==document.documentElement.className&&(document.documentElement.className=this.HTMLClass),this.bodyClass&&this.bodyClass!==document.body.className&&(document.body.className=this.bodyClass),this.title&&document.title!==this.title&&(document.title=this.title),this.wrapper.appendChild(this.view),this.onEnter&&this.onEnter();const e=()=>{this.onEnterCompleted&&this.onEnterCompleted(),t()};this.transition?this.transition.show().then(e):e()})}hide(){return new Promise(t=>{this.wrapper=this.view.parentNode,this.onLeave&&this.onLeave();const e=()=>{this.wrapper.removeChild(this.view),this.onLeaveCompleted&&this.onLeaveCompleted(),t()};this.transition?this.transition.hide().then(e):e()})}};const y={mode:"same-origin",method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"};const v={Core:class extends s.a{constructor(t){super(),this.renderers=t.renderers,this.transitions=t.transitions,this.mode=t.mode||"out-in",this.state={},this.cache={},this.empty=!1,this.loading=!1,this.navigating=!1,this.page=document.documentElement.outerHTML,this.pathname=g.getPathname(window.location.href),this.cache[this.pathname]=this.page;const e=document.querySelector("[router-view]"),n=g.getTransition(this.page,this.transitions);this.from=g.getRenderer(this.page,this.renderers)||w,this.from=new this.from(this.page,e,n),this.from.onEnter&&this.from.onEnter(),this.from.onEnterCompleted&&this.from.onEnterCompleted(),window.addEventListener("popstate",this.popState.bind(this)),this.bubble()}bubble(){document.addEventListener("click",t=>{if("A"===t.target.tagName){const e=g.getAnchor(t.target.href),n=g.getPathname(t.target.href);t.target.target||(t.preventDefault(),this.navigating||n===this.pathname?e&&(window.location.href=t.target.href):this.pushState(t))}})}popState(){g.getPathname(window.location.href)!==this.pathname&&this.beforeFetch(window.location.href,!1)}pushState(t){this.beforeFetch(t.target.href,!0)}beforeFetch(t,e){this.loading=!0,this.navigating=!0,this.state=g.getInfos(t),this.pathname=g.getPathname(t),this.emit("NAVIGATE_OUT",this.from,this.state),this.from.hide().then(()=>{this.empty=!0,this.loading||this.complete()}),this.cache.hasOwnProperty(this.pathname)?this.beforePush(this.cache[this.pathname],e):this.fetch().then(t=>this.beforePush(t,e))}fetch(){return fetch(this.state.url,y).then(t=>{if(t.status>=200&&t.status<300)return t.text();throw this.emit("NAVIGATE_ERROR",t),new Error(t.statusText)})}beforePush(t,e){e&&window.history.pushState(this.state,"",this.state.url),this.push(t)}push(t){this.loading=!1,this.cache[this.pathname]=t;const e=g.getView(t),n=g.getTransition(t,this.transitions);this.to=g.getRenderer(t,this.renderers)||w,this.to=new this.to(t,e,n),this.empty&&this.complete()}complete(){this.emit("NAVIGATE_IN",this.to,this.state),window.scrollTo(0,0),this.to.show().then(()=>{this.empty=!1,this.navigating=!1,this.emit("NAVIGATE_END",this.from,this.to,this.state),this.from=this.to})}},Helpers:g,Renderer:w,Transition:class{constructor(t){this.view=t}show(){return new Promise(t=>{this.in&&"function"==typeof this.in&&this.in(this.view,t)})}hide(){return new Promise(t=>{this.out&&"function"==typeof this.out&&this.out(this.view,t)})}}};e.default=v}])});