!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Highway",[],e):"object"==typeof exports?exports.Highway=e():t.Highway=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e,n){"use strict";var r=/\?([\w_\-.=&]+)/,o=/(#.*)$/,i=/(https?:\/\/[\w\-.]+)/,a=/https?:\/\/.*?(\/[\w_\-./]+)/,u=/[-_](\w)/g;function s(t){var e=t.match(i);return e?e[1]:null}function f(t){var e=t.match(a);return e?e[1]:null}function c(t){var e=t.match(o);return e?e[1]:null}function l(t){var e=t.match(r);if(!e)return null;for(var n=e[1].split("&"),o={},i=0;i<n.length;i++){var a=n[i].split("="),u=a[0],s=a[1];o[u]=s}return o}function h(t){return(new DOMParser).parseFromString(t,"text/html")}function p(t){return h(t).querySelector("[router-view]")}function d(t){return p(t).getAttribute("router-view")}t.exports={getDOM:h,getSlug:d,getView:p,getInfos:function(t){return{url:t,anchor:c(t),origin:s(t),params:l(t),pathname:f(t)}},getParam:function(t,e){var n=l(t);return n.hasOwnProperty(e)?n[e]:null},getParams:l,getOrigin:s,getAnchor:c,getPathname:f,getRenderer:function(t,e){var n=d(t);return e.hasOwnProperty(n)?e[n]:null},getTransition:function(t,e){if(void 0===e)return null;var n=d(t);return e.hasOwnProperty(n)&&e[n]?e[n]:e.hasOwnProperty("default")?e.default:null},camelize:function(t){return t.replace(u,function(t,e){return e?e.toUpperCase():""})}}},function(t,e,n){"use strict";var r,o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(0),a=(r=i)&&r.__esModule?r:{default:r};var u=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=n,this.page=a.default.getDOM(e),this.title=this.page.title,this.transition=r?new r(n):null,this.bodyClass=this.page.body.className,this.HTMLClass=this.page.documentElement.className,this.wrapper=null}return o(t,[{key:"show",value:function(){var t=this;return new Promise(function(e){t.wrapper=document.querySelector("[router-wrapper]"),t.HTMLClass&&t.HTMLClass!==document.documentElement.className&&(document.documentElement.className=t.HTMLClass),t.bodyClass&&t.bodyClass!==document.body.className&&(document.body.className=t.bodyClass),t.title&&document.title!==t.title&&(document.title=t.title),t.wrapper.appendChild(t.view),t.onEnter&&t.onEnter();var n=function(){t.onEnterCompleted&&t.onEnterCompleted(),e()};t.transition?t.transition.show().then(n):n()})}},{key:"hide",value:function(){var t=this;return new Promise(function(e){t.wrapper=t.view.parentNode,t.onLeave&&t.onLeave();var n=function(){t.wrapper.removeChild(t.view),t.onLeaveCompleted&&t.onLeaveCompleted(),e()};t.transition?t.transition.hide().then(n):n()})}}]),t}();t.exports=u},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e}return r(t,[{key:"show",value:function(){var t=this;return new Promise(function(e){t.in&&"function"==typeof t.in&&t.in(t.view,e)})}},{key:"hide",value:function(){var t=this;return new Promise(function(e){t.out&&"function"==typeof t.out&&t.out(t.view,e)})}}]),t}();t.exports=o},function(t,e){function n(){}n.prototype={on:function(t,e,n){var r=this.e||(this.e={});return(r[t]||(r[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var r=this;function o(){r.off(t,o),e.apply(n,arguments)}return o._=e,this.on(t,o,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),r=0,o=n.length;r<o;r++)n[r].fn.apply(n[r].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),r=n[t],o=[];if(r&&e)for(var i=0,a=r.length;i<a;i++)r[i].fn!==e&&r[i].fn._!==e&&o.push(r[i]);return o.length?n[t]=o:delete n[t],this}},t.exports=n},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=u(n(3)),i=u(n(0)),a=u(n(1));function u(t){return t&&t.__esModule?t:{default:t}}var s={mode:"same-origin",method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"},f=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));n.renderers=t.renderers,n.transitions=t.transitions,n.mode=t.mode||"out-in",n.state={},n.cache={},n.navigating=!1,n.page=document.documentElement.outerHTML,n.pathname=i.default.getPathname(window.location.href),n.cache[n.pathname]=n.page;var r=document.querySelector("[router-view]"),o=i.default.getTransition(n.page,n.transitions);return n.from=i.default.getRenderer(n.page,n.renderers)||a.default,n.from=new n.from(n.page,r,o),n.from.onEnter&&n.from.onEnter(),n.from.onEnterCompleted&&n.from.onEnterCompleted(),window.addEventListener("popstate",n.popState.bind(n)),n.bubble(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"bubble",value:function(){var t=this;document.addEventListener("click",function(e){if("A"===e.target.tagName){var n=i.default.getAnchor(e.target.href),r=i.default.getPathname(e.target.href);e.target.target||(e.preventDefault(),t.navigating||r===t.pathname?n&&(window.location.href=e.target.href):t.pushState(e))}})}},{key:"popState",value:function(){i.default.getPathname(window.location.href)!==this.pathname&&this.beforeFetch(window.location.href,!1)}},{key:"pushState",value:function(t){this.beforeFetch(t.target.href,!0)}},{key:"beforeFetch",value:function(t,e){var n=this;if(this.emit("NAVIGATE_CALL"),this.navigating=!0,this.state=i.default.getInfos(t),this.pathname=i.default.getPathname(t),this.cache.hasOwnProperty(this.pathname))return this.push(this.cache[this.pathname]),void(e&&window.history.pushState(this.state,"",this.state.url));this.fetch().then(function(t){e&&window.history.pushState(n.state,"",n.state.url),n.push(t)})}},{key:"fetch",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){var t=this;return fetch(this.state.url,s).then(function(e){if(e.status>=200&&e.status<300)return e.text();throw t.emit("NAVIGATE_ERROR"),new Error(e.statusText)})})},{key:"push",value:function(t){var e=this;this.cache[this.pathname]=t;var n=i.default.getView(t),r=i.default.getTransition(t,this.transitions);this.to=i.default.getRenderer(t,this.renderers)||a.default,this.to=new this.to(t,n,r),this.emit("NAVIGATE_START",this.from,this.to,this.state);var o=i.default.camelize(this.mode);"function"==typeof this[o]&&this[o]().then(function(){e.navigating=!1,e.emit("NAVIGATE_END",e.from,e.to,e.state),e.from=e.to,i.default.getAnchor(e.state.url)&&e.scrollTo(i.default.getAnchor(e.state.url))})}},{key:"outIn",value:function(){var t=this;return this.emit("NAVIGATE_OUT",this.from,this.to,this.state),this.from.hide().then(function(){window.scrollTo(0,0)}).then(function(){t.emit("NAVIGATE_IN",t.from,t.to,t.state),t.to.show()})}},{key:"inOut",value:function(){var t=this;return this.emit("NAVIGATE_IN",this.from,this.to,this.state),this.to.show().then(function(){window.scrollTo(0,0)}).then(function(){t.emit("NAVIGATE_OUT",t.from,t.to,t.state),t.from.hide()})}},{key:"both",value:function(){return this.emit("NAVIGATE_IN",this.from,this.to,this.state),this.emit("NAVIGATE_OUT",this.from,this.to,this.state),Promise.all([this.to.show(),this.from.hide()]).then(function(){window.scrollTo(0,0)})}},{key:"scrollTo",value:function(t){var e=document.querySelector(t);e&&window.scrollTo(e.offsetLeft,e.offsetTop)}}]),e}();t.exports=f},function(t,e,n){"use strict";var r=u(n(4)),o=u(n(0)),i=u(n(1)),a=u(n(2));function u(t){return t&&t.__esModule?t:{default:t}}var s={Core:r.default,Helpers:o.default,Renderer:i.default,Transition:a.default};t.exports=s}])});